#include <graphics.h>
#include <cmath>

int xmin = 150, ymin = 150;
int xmax = 450, ymax = 350;

bool inside(double x, double y) {
    return (x >= xmin && x <= xmax && y >= ymin && y <= ymax);
}

void midpointClip(double x1, double y1, double x2, double y2) {
    if (inside(x1,y1) && inside(x2,y2)) {
        line(x1,y1,x2,y2);
        return;
    }

    if (fabs(x2-x1) < 1 && fabs(y2-y1) < 1) return;

    double xm = (x1 + x2) / 2.0;
    double ym = (y1 + y2) / 2.0;

    midpointClip(x1, y1, xm, ym);
    midpointClip(xm, ym, x2, y2);
}

int main() {
    int gd = DETECT, gm;
    initgraph(&gd, &gm, "");

    rectangle(xmin, ymin, xmax, ymax);

    double x1 = 50, y1 = 50;
    double x2 = 500, y2 = 400;

    setcolor(GREEN);
    midpointClip(x1, y1, x2, y2);

    getch();
    closegraph();
    return 0;
}
